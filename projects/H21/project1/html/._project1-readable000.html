<!--
Automatically generated HTML file from DocOnce source
(https://github.com/doconce/doconce/)
-->
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="DocOnce: https://github.com/doconce/doconce/" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<meta name="description" content="The tip of the iceberg">

<title>The tip of the iceberg</title>

<!-- Bootstrap style: bootswatch_readable -->
<link href="https://netdna.bootstrapcdn.com/bootswatch/3.1.1/readable/bootstrap.min.css" rel="stylesheet">
<!-- not necessary
<link href="https://netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.css" rel="stylesheet">
-->

<style type="text/css">
/* Let inline verbatim have the same color as the surroundings */
code { color: inherit; background-color: transparent; }

/* Add scrollbar to dropdown menus in bootstrap navigation bar */
.dropdown-menu {
   height: auto;
   max-height: 400px;
   overflow-x: hidden;
}

/* Adds an invisible element before each target to offset for the navigation
   bar */
.anchor::before {
  content:"";
  display:block;
  height:64px;      /* fixed header height for style bootswatch_readable */
  margin:-64px 0 0; /* negative fixed header height */
}
</style>


</head>

<!-- tocinfo
{'highest level': 1,
 'sections': [('Before you start', 1, None, '___sec0'),
              ('Exercise 1: Finite-precision arithmetic',
               1,
               'ex:round_err',
               'ex:round_err'),
              ('Exercise 2: Need for speed? (NumPy)',
               1,
               'exer:numpy',
               'exer:numpy'),
              ('Exercise 3, Part I: Finite Differences (FD) with Functions',
               1,
               None,
               '___sec3'),
              ('Exercise 3, Part II: FD with Classes',
               1,
               'exer:fd_classes',
               'exer:fd_classes'),
              ('A Crash Course on Classes',
               2,
               'exer:crash_course',
               'exer:crash_course'),
              ('Exercise 4: A song of ice and fire?',
               1,
               'exer:isostasy',
               'exer:isostasy'),
              ('Theory', 2, None, '___sec7'),
              ('Melting of an iceberg', 3, None, '___sec8'),
              ('Freeboard', 3, None, '___sec9'),
              ('Appendix A: Package management with `conda`',
               1,
               None,
               '___sec10'),
              ('Getting `conda` up and running', 2, None, '___sec11'),
              ('Creating virtual environments', 2, None, '___sec12'),
              ('Selecting the version of Python to use', 2, None, '___sec13'),
              ('Appendix B: Some intermediate Python tips',
               1,
               None,
               '___sec14'),
              ('Guidelines for project submission', 1, None, '___sec15'),
              ('Bibliography', 1, None, '___sec16')]}
end of tocinfo -->

<body>



<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  TeX: {
     equationNumbers: {  autoNumber: "none"  },
     extensions: ["AMSmath.js", "AMSsymbols.js", "autobold.js", "color.js"]
  }
});
</script>
<script type="text/javascript" async
 src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>



    
<!-- Bootstrap navigation bar -->
<div class="navbar navbar-default navbar-fixed-top">
  <div class="navbar-header">
    <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-responsive-collapse">
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
    </button>
    <a class="navbar-brand" href="project1-readable.html">The tip of the iceberg</a>
  </div>

  <div class="navbar-collapse collapse navbar-responsive-collapse">
    <ul class="nav navbar-nav navbar-right">
      <li class="dropdown">
        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Contents <b class="caret"></b></a>
        <ul class="dropdown-menu">
     <!-- navigation toc: --> <li><a href="#___sec0" style="font-size: 80%;"><b>Before you start</b></a></li>
     <!-- navigation toc: --> <li><a href="#ex:round_err" style="font-size: 80%;"><b>Exercise 1: Finite-precision arithmetic</b></a></li>
     <!-- navigation toc: --> <li><a href="#exer:numpy" style="font-size: 80%;"><b>Exercise 2: Need for speed? (NumPy)</b></a></li>
     <!-- navigation toc: --> <li><a href="#___sec3" style="font-size: 80%;"><b>Exercise 3, Part I: Finite Differences (FD) with Functions</b></a></li>
     <!-- navigation toc: --> <li><a href="#exer:fd_classes" style="font-size: 80%;"><b>Exercise 3, Part II: FD with Classes</b></a></li>
     <!-- navigation toc: --> <li><a href="#exer:crash_course" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;A Crash Course on Classes</a></li>
     <!-- navigation toc: --> <li><a href="#exer:isostasy" style="font-size: 80%;"><b>Exercise 4: A song of ice and fire?</b></a></li>
     <!-- navigation toc: --> <li><a href="#___sec7" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Theory</a></li>
     <!-- navigation toc: --> <li><a href="#___sec8" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Melting of an iceberg</a></li>
     <!-- navigation toc: --> <li><a href="#___sec9" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Freeboard</a></li>
     <!-- navigation toc: --> <li><a href="#___sec10" style="font-size: 80%;"><b>Appendix A: Package management with <code>conda</code></b></a></li>
     <!-- navigation toc: --> <li><a href="#___sec11" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Getting <code>conda</code> up and running</a></li>
     <!-- navigation toc: --> <li><a href="#___sec12" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Creating virtual environments</a></li>
     <!-- navigation toc: --> <li><a href="#___sec13" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Selecting the version of Python to use</a></li>
     <!-- navigation toc: --> <li><a href="#___sec14" style="font-size: 80%;"><b>Appendix B: Some intermediate Python tips</b></a></li>
     <!-- navigation toc: --> <li><a href="#___sec15" style="font-size: 80%;"><b>Guidelines for project submission</b></a></li>
     <!-- navigation toc: --> <li><a href="#___sec16" style="font-size: 80%;"><b>Bibliography</b></a></li>

        </ul>
      </li>
    </ul>
  </div>
</div>
</div> <!-- end of navigation bar -->

<div class="container">

<p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p> <!-- add vertical space -->

<a name="part0000"></a>
<!-- ------------------- main content ---------------------- -->



<div class="jumbotron">
<center><h1>The tip of the iceberg</h1></center>  <!-- document title -->

<p>
<!-- author(s): MOD510: Mandatory project \#1, and Deadline: 12 September 2021 (23:59) -->

<center>
<b>MOD510: Mandatory project \#1</b> 
</center>

<center>
<b>Deadline: 12 September 2021 (23:59)</b> 
</center>

<p>
<!-- institution(s) -->

<br>
<p>
<center><h4>Aug 30, 2021</h4></center> <!-- date -->
<br>
<p>
<b>Learning objectives.</b>
By completing this project, the student will:

<ul>
<li> Get experience in structuring and writing a report.</li>
<li> Write new functions and classes in Python.</li>
<li> Explore numerical round-off and truncation errors.</li>
<li> Be introduced to useful Python libraries for scientific computing.</li>
</ul>
<b>Abstract.</b> Because computers have finite memory, numerical errors must always
be taken into account when doing calculations, especially when
working with floating-point numbers <a href="#goldberg1991every">[1]</a>.
In the first parts of this project we investigate round-off errors and
truncation errors using the Python programming language, and we
discuss how different implementation strategies affect code
efficiency and code clarity. In particular, we show how coding with
classes can simplify the implementation of numerical algorithms.
Finally, we highlight the power of available Python libraries to
quickly visualize and manipulate large data sets. To this end, we
look at how ice melting in Antarctica could affect
sea level rise <a href="#fretwell2013bedmap2">[2]</a>.

<p>
</div> <!-- end jumbotron -->

<h1 id="___sec0" class="anchor">Before you start   </h1>

<p>
In the last part of this project we are going to import ice data for Antarctica using the <code>rockhound</code> library. On some platforms it is a challenge to install this library, however if you use <em>environments</em> in conda it should be much easier, see Appendix A for more information. We recommend you to do the following:

<ol>
<li> On the windows start menu, open Anaconda prompt, (located in the Anaconda folder)</li>
<li> Create a new conda environment by running the commands below (in the Anaconda prompt)</li>
</ol>

<p>

<!-- code=python (!bc pypro) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%; margin: 0;"><span></span>conda update conda
</pre></div>
<p>
It probably goes without saying, but this command updates the conda package. The <code>rockhound</code> library and <code>cmocean</code> library are not in the default channel so you need to add <code>conda-forge</code>
<p>

<!-- code=python (!bc pypro) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%; margin: 0;"><span></span>conda config <span style="color: #666666">--</span>add channels conda<span style="color: #666666">-</span>forge
</pre></div>
<p>
Now, we can create an environment <code>project1</code> with the following packages
<p>

<!-- code=python (!bc pypro) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%; margin: 0;"><span></span>conda create <span style="color: #666666">-</span>n project1 python matplotlib numpy pandas rockhound cmocean pip spyder jupyter
</pre></div>
<p>
Entering all the package names when creating the new environment forces conda to check for dependencies, and makes sure that there are no conflicts.
Do
<p>

<!-- code=python (!bc pypro) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%; margin: 0;"><span></span>conda activate project1
</pre></div>
<p>
Now you can do e.g. <code>jupyter notebook</code> and continue to work on the project. Later you can add packages using <code>conda install &lt;package-name&gt;</code>.
<div class="alert alert-block alert-success alert-text-normal"><b>pip or conda</b>
Always try <code>conda install &lt;package-name&gt;</code> first, even if you find on the web that people have done <code>pip install &lt;package-name&gt;</code>. If <code>conda install</code> fails you can try <code>pip install</code>.
</div>


<h1 id="ex:round_err" class="anchor">Exercise 1: Finite-precision arithmetic</h1>

<p>
<b>Part 1.</b>

<p>
Run the following code snippet:
<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%; margin: 0;"><span></span><span style="color: #008000; font-weight: bold">import</span> <span style="color: #0000FF; font-weight: bold">sys</span>
sys<span style="color: #666666">.</span>float_info
</pre></div>
<ul>
<li> Explain the meaning of the printed-out numbers using the IEEE Standard for floating-point arithmetic.</li>
</ul>

<b>Part 2.</b>

<ul>
<li> Derive the following values yourself: <code>max</code>, <code>min</code>, <code>epsilon</code>.</li>
</ul>

<b>Part 3.</b>

<p>
In Python, typing <code>0.1+0.2</code> does not (typically) produce the same output as <code>0.3</code>.

<ul>
<li> Why not?</li>
</ul>

<b>Part 4.</b>

<ul>
<li> Should you use the <code>==</code>-operator to test whether two floating-point numbers are equal?</li>
<li> Why / why not?</li>
</ul>

<h1 id="exer:numpy" class="anchor">Exercise 2: Need for speed? (NumPy)</h1>

<p>
The purpose of this exercise is to learn a little bit about
<a href="https://numpy.org/" target="_self">NumPy</a>, which is an incredibly useful Python library.
A major reason for its popularity is efficiency: doing computations with NumPy
arrays (objects of the type <code>ndarray</code>) instead of using native Python lists can,
by itself, speed up a program by several orders of magnitude!
The mechanism for speed-up is <a href="https://www.oreilly.com/library/view/python-for-data/9781449323592/ch04.html" target="_self">vectorized computation</a>.

<p>
<div class="alert alert-block alert-success alert-text-normal"><b>Vectorized functions</b>
Using NumPy arrays allows you to create vectorized functions; functions that
operate on a whole array at once, rather than looping over the elements
one-by-one inside a custom written loop.

<p>
The way vectorization works behind the scenes is still via loops
(optimized, pre-compiled C code), but as Python programmer you do not need
to worry about the details.
</div>


<p>
<b>Part 1.</b>

<p>
The following code block gives an example of a vectorized function:

<p>

<!-- code=python (!bc pypro) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%; margin: 0;"><span></span>x <span style="color: #666666">=</span> np<span style="color: #666666">.</span>linspace(<span style="color: #666666">0</span>, <span style="color: #666666">1</span>, <span style="color: #666666">10</span>)
fx <span style="color: #666666">=</span> np<span style="color: #666666">.</span>exp(<span style="color: #666666">-</span>x)  <span style="color: #408080; font-style: italic"># apply f(t)=exp(-t) to each element in the array x</span>
</pre></div>
<p>
Notice the usage of <code>np.exp</code> instead of using the exponential function provided
in the built-in <a href="https://docs.python.org/3/library/math.html" target="_self">math</a>
library; this is an example of a
<a href="https://docs.scipy.org/doc/numpy/reference/ufuncs.html" target="_self">universal function</a>.

<ul>
<li> What happens if you change <code>x</code> to be a list?</li>
<li> If <code>x</code> is a list, how can you modify the second line above to calculate <code>fx</code>?</li>
</ul>

Tip: Use either a custom loop, or a <a href="https://realpython.com/list-comprehension-python/" target="_self">list comprehension</a>.

<p>
<b>Part 2.</b>

<p>
As already hinted at, the NumPy library comes with a plethora of useful
features and functions. The code snippets below show some examples:

<p>

<!-- code=python (!bc pypro) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%; margin: 0;"><span></span>np<span style="color: #666666">.</span>zeros(<span style="color: #666666">20</span>)
</pre></div>
<p>

<!-- code=python (!bc pypro) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%; margin: 0;"><span></span>np<span style="color: #666666">.</span>ones(<span style="color: #666666">20</span>)
</pre></div>
<p>

<!-- code=python (!bc pypro) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%; margin: 0;"><span></span>np<span style="color: #666666">.</span>linspace(<span style="color: #666666">0</span>, <span style="color: #666666">10</span>, <span style="color: #666666">11</span>)
</pre></div>
<p>

<!-- code=python (!bc pypro) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%; margin: 0;"><span></span>np<span style="color: #666666">.</span>linspace(<span style="color: #666666">0</span>, <span style="color: #666666">10</span>, <span style="color: #666666">11</span>, endpoint<span style="color: #666666">=</span><span style="color: #008000; font-weight: bold">False</span>)
</pre></div>
<p>

<!-- code=python (!bc pypro) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%; margin: 0;"><span></span>vector <span style="color: #666666">=</span> np<span style="color: #666666">.</span>arange(<span style="color: #666666">5</span>) <span style="color: #666666">+</span> <span style="color: #666666">1</span>
<span style="color: #666666">2*</span>vector
</pre></div>
<ul>
<li> Explain what each line of code does.</li>
<li> How would you produce the same output using native Python lists?</li>
</ul>

<b>Part 3.</b>

<p>
Frequently you will want to extract a subset of values from an array based
on some kind of criterion. For example, you might want to count the number
of non-zero numbers, or identify all values exceeding a certain threshold.
With NumPy, suchs tasks are easily achieved using
<a href="https://jakevdp.github.io/PythonDataScienceHandbook/02.06-boolean-arrays-and-masks.html" target="_self">boolean masking</a>, e.g.:

<p>

<!-- code=python (!bc pypro) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%; margin: 0;"><span></span>array_of_numbers <span style="color: #666666">=</span> np<span style="color: #666666">.</span>array([<span style="color: #666666">4</span>, <span style="color: #666666">8</span>, <span style="color: #666666">15</span>, <span style="color: #666666">16</span>, <span style="color: #666666">23</span>, <span style="color: #666666">42</span>])
nnz <span style="color: #666666">=</span> np<span style="color: #666666">.</span>count_nonzero(array_of_numbers)
<span style="color: #008000">print</span>(<span style="color: #BA2121">f&#39;There are </span><span style="color: #BB6688; font-weight: bold">{</span>nnz<span style="color: #BB6688; font-weight: bold">}</span><span style="color: #BA2121"> non-zero numbers in the array.&#39;</span>)
is_even <span style="color: #666666">=</span> (array_of_numbers <span style="color: #666666">%</span> <span style="color: #666666">2</span> <span style="color: #666666">==</span> <span style="color: #666666">0</span>)
is_greater_than_17 <span style="color: #666666">=</span> (array_of_numbers <span style="color: #666666">&gt;</span> <span style="color: #666666">17</span>)
is_even_and_greater_than_17 <span style="color: #666666">=</span> is_even <span style="color: #666666">&amp;</span> is_greater_than_17
</pre></div>
<p>
However, the following code line does not execute:

<p>

<!-- code=python (!bc pypro) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%; margin: 0;"><span></span>is_even_and_greater_than_17 <span style="color: #666666">=</span> is_even <span style="color: #AA22FF; font-weight: bold">and</span> is_greater_than_17
</pre></div>
<ul>
<li> Why not?</li>
</ul>

<b>Part 4.</b>

<p>
The function <a href="https://numpy.org/doc/stable/reference/generated/numpy.where.html" target="_self">np.where</a>
can also be used to select elements from an array.

<ul>
<li> Explain the output of the following two lines of code:</li>
</ul>

<p>

<!-- code=python (!bc pypro) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%; margin: 0;"><span></span>np<span style="color: #666666">.</span>where(array_of_numbers <span style="color: #666666">&gt;</span> <span style="color: #666666">17</span>)[<span style="color: #666666">0</span>]
</pre></div>
<p>

<!-- code=python (!bc pypro) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%; margin: 0;"><span></span>np<span style="color: #666666">.</span>where(array_of_numbers <span style="color: #666666">&gt;</span> <span style="color: #666666">17</span>, <span style="color: #666666">1</span>, <span style="color: #666666">0</span>)
</pre></div>

<h1 id="___sec3" class="anchor">Exercise 3, Part I: Finite Differences (FD) with Functions </h1>

<p>
In scientific computing one often needs to calculate derivatives of functions.
However, exact formulas may not be available, in which case numerical estimates
are needed. To evaluate the correctness of our programmed numerical methods,
it is still wise to choose test functions where the derivative is known
beforehand.

<p>
In this exercise, we consider a function that is relevant for describing wave
phenomenona:
$$
\begin{equation}
f(x) = \sin(bx)\cdot e^{-ax^2}
\tag{1}
\end{equation}
$$

<p>
One way to implement the <a href="https://realpython.com/defining-your-own-python-function/" target="_self">function in Python</a> is:
<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%; margin: 0;"><span></span><span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">f</span>(x, a<span style="color: #666666">=0.1</span>, b<span style="color: #666666">=10</span>):
    <span style="color: #008000; font-weight: bold">return</span> np<span style="color: #666666">.</span>sin(b<span style="color: #666666">*</span>x)<span style="color: #666666">*</span>np<span style="color: #666666">.</span>exp(<span style="color: #666666">-</span>a<span style="color: #666666">*</span>x<span style="color: #666666">*</span>x)
</pre></div>
<p>
We have chosen to define <code>a</code> and <code>b</code> as <em>default arguments</em>, which allows us to evaluate the function at \( x=1 \) by simply typing <code>f(1)</code>;
this is equivalent to the command <code>f(1, 0.1, 10)</code>. If you want to change the <code>b</code> parameter, you can do, e.g., <code>f(1, b=2)</code>.
Note also that the function works both when <code>x</code> is a single number <em>and</em> when it is a Numpy array. This is because we use the Numpy versions of the sine (<code>np.sin</code>) and exponential (<code>np.exp</code>) functions.

<p>
<div class="alert alert-block alert-success alert-text-normal"><b>Python functions are first-class!</b>
An important feature of Python is that functions are
<a href="https://en.wikipedia.org/wiki/First-class_function" target="_self">first-class objects</a>,
meaning that you can assign them to variables, you can store them inside
various containers and data structures, they can be passed as input arguments
to other functions, and they may be return values of other functions.
</div>


<p>
We will exploit this property of Python several times during this project.

<p>
<b>Part 1.</b>

<p>
It is always a good idea to start by visualizing the function in a plot.

<ul>
<li> Make a Python function that plots \( f(x) \) from equation <a href="#mjx-eqn-1">(1)</a> over an arbitrary closed interval.</li>
<li> Use the function to plot \( f(x) \) in the range \( [-10,10] \). Try to make your figure similar to the one shown in figure <a href="#fig:p1:wave">1</a></li>
</ul>

<center> <!-- figure label: --> <div id="fig:p1:wave"></div> <!-- FIGURE -->
<hr class="figure">
<center><p class="caption">Figure 1:  A plot of \( f(x) \).  <!-- caption label: fig:p1:wave --> </p></center>
<p><img src="fig-project1/wave.png" align="bottom" width=800></p>
</center>

<p>
<b>Part 2.</b>

<p>
The analytical derivative of \( f(x) \) is
$$
\begin{equation}
f^\prime(x) =b \cos(bx)\cdot e^{-ax^2} - 2ax\sin(bx)\cdot e^{-ax^2}
\tag{2}
\end{equation}
$$


<ul>
<li> Write a Python function that calculates the derivative defined in equation <a href="#mjx-eqn-2">(2)</a>.</li>
</ul>

<b>Part 3.</b>

<p>
Next, we are going to write a Python function that calculates the numerical
derivative of an <em>arbitrary</em> single-variable function <code>f</code> at a point \( x \)
using finite differences. If <code>f</code> only depends on \( x \), this is extremely easy:
we can  simply take  <code>f</code>, <code>x</code>, and <code>h</code> (step-size) as input arguments
to our derivative function. Assuming it is called <code>calc_derivative</code>,
it could work something like this:
<p>

<!-- code=python (!bc pypro) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%; margin: 0;"><span></span>df_x <span style="color: #666666">=</span> calc_derivative(f, x<span style="color: #666666">=1.0</span>, h<span style="color: #666666">=1.0e-3</span>)
</pre></div>
<p>
However, the function in equation <a href="#mjx-eqn-1">(1)</a> depends on two additional
input parameters, <code>a</code> and <code>b</code>. We can of course add these two as extra
arguments to the derivative function, but then we would lose generality,
for not every function has the same two parameters. A way out of this
dilemma could be to create a new function each time you choose values
for <code>a</code> and <code>b</code>, e.g:
<p>

<!-- code=python (!bc pypro) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%; margin: 0;"><span></span><span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">g</span>(x):
    <span style="color: #BA2121; font-style: italic">&quot;&quot;&quot;</span>
<span style="color: #BA2121; font-style: italic">    The function g(x) = sin(10x) * exp(-0.1x^2).</span>
<span style="color: #BA2121; font-style: italic">    &quot;&quot;&quot;</span>
    <span style="color: #008000; font-weight: bold">return</span> f(x, <span style="color: #666666">0.1</span>, <span style="color: #666666">10.0</span>)
</pre></div>
<p>
Another possibility is to use the the <a href="https://realpython.com/python-kwargs-and-args/" target="_self">args</a> mechanism,
which lets you pass around a variable number of parameters to a function.
An example of how this works is:
<p>

<!-- code=python (!bc pypro) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%; margin: 0;"><span></span><span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">calc_derivative</span>(f, x, h, <span style="color: #666666">*</span>args):
    <span style="color: #008000; font-weight: bold">return</span> (f(x, <span style="color: #666666">*</span>args) <span style="color: #666666">-</span> f(x<span style="color: #666666">-</span>h, <span style="color: #666666">*</span>args))<span style="color: #666666">/</span>h
</pre></div>
<ul>
<li> Write a Python function that calculates the derivative of an arbitrary function using the <em>forward difference</em> method (see section 1.3 in <a href="#hiorth">[3]</a> ).</li>
<li> Apply your function to the particular case of equation <a href="#mjx-eqn-1">(1)</a> and \( x=1 \). Use a suitable value of \( h \), e.g. \( h=1e-2 \), and check that your estimate agrees reasonably well with the <em>analytical solution</em>.</li>
</ul>

<b>Part 4.</b>

<ul>
<li> Write another Python function that calculates \( f^{\prime}(x) \) with the <em>central difference</em> method (see section 1.4 in <a href="#hiorth">[3]</a>).</li>
</ul>

<b>Part 5.</b>

<p>
We want to quantify the error in our numerical estimates. To this end,
we start by choosing a point at which to evaluate the numerical derivative of
the function in equation <a href="#mjx-eqn-1">(1)</a>, e.g., \( x=1 \).
Next:

<ul>
<li> Make a figure in which you plot the <em>absolute error</em> versus step size, \( h \).</li>
<li> Vary the step size logarithmically between \( 10^{-16} \) and \( 1 \).</li>
<li> The figure should include one error curve for the <em>forward difference</em> method, and another for the <em>central difference</em> methods.</li>
</ul>

<b>Part 6.</b>

<ul>
<li> Comment on what you observe in the figure you made. When is the numerical error smallest, and why? Is it what you expect from a theoretical analysis using Taylor's formula?</li>
</ul>

<h1 id="exer:fd_classes" class="anchor">Exercise 3, Part II: FD with Classes</h1>

<p>
Implementing numerical algorithms with free functions, as we did in the
previous exercise, is perfectly fine, and you can complete MOD510 by only
coding in this way. However, experience has taught us that it is easy to
introduce unnecessary errors when using this approach. In many cases you
are better off by also using classes, and maybe <a href="https://realpython.com/python3-object-oriented-programming/" target="_self">object-oriented design</a>.
In this exercise, you will get some practice in coding with classes.
This knowledge will come in handy in later projects, and in any case
it is a good tool to have in your programming toolkit.

<p>
Previously, we worked with a function having two input parameters, \( a \) and \( b \).
Implementing numerical algorithms using free functions was then simple.
However, in a more complicated situation there
could be dozens, or even hundreds, of parameters to keep track of.
Most of these parameters might have fixed values, but frequently you will
want to re-run a model with slightly different parameters than before.
If you are not using classes, it is very easy to use the wrong parameters.
This is especially true when working in a Jupyter notebook, since you might
run code blocks in any order; if you forget to excute a cell that is
responsible for updating one of your variables, your subsqeuent calculations
will be wrong!

<p>
<div class="alert alert-block alert-success alert-text-normal"><b>Key take-away: Classes provide encapsulation</b>
By wrapping parts of your code into classes, and particular realizations of
classes (objects), you facilitate code re-use, and it can make your code
easier to understand and work with, thus reducing the probability of
introducing bugs which may be hard to track down.
</div>


<h2 id="exer:crash_course" class="anchor">A Crash Course on Classes</h2>

<p>
To get started, there are really only a couple of things you need to know.
First, all of your classes should include a special function called <code>__init__</code>,
in which you declare the variables (attributes) you wish an instance / object
of the class to keep track of.

<p>
Second, inside the class all class attributes should be prefixed with <code>self</code>,
followed by a dot. Third, functions defined inside a class should have <code>self</code> as the first
function argument. All of this is best understood via an example:

<p>

<!-- code=python (!bc pypro) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%; margin: 0;"><span></span><span style="color: #008000; font-weight: bold">class</span> <span style="color: #0000FF; font-weight: bold">WavePacket</span>:
    <span style="color: #BA2121; font-style: italic">&quot;&quot;&quot;</span>
<span style="color: #BA2121; font-style: italic">    A class representation of a wave packet-function.</span>
<span style="color: #BA2121; font-style: italic">    &quot;&quot;&quot;</span>
    <span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">__init__</span>(<span style="color: #008000">self</span>, a, b):
        <span style="color: #008000">self</span><span style="color: #666666">.</span>a <span style="color: #666666">=</span> a
        <span style="color: #008000">self</span><span style="color: #666666">.</span>b <span style="color: #666666">=</span> b

    <span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">f</span>(<span style="color: #008000">self</span>, x):
        <span style="color: #008000; font-weight: bold">return</span> np<span style="color: #666666">.</span>sin(<span style="color: #008000">self</span><span style="color: #666666">.</span>b<span style="color: #666666">*</span>x)<span style="color: #666666">*</span>np<span style="color: #666666">.</span>exp(<span style="color: #666666">-</span><span style="color: #008000">self</span><span style="color: #666666">.</span>a<span style="color: #666666">*</span>x<span style="color: #666666">*</span>x)

    <span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">plot</span>(<span style="color: #008000">self</span>, <span style="color: #008000">min</span><span style="color: #666666">=-10</span>, <span style="color: #008000">max</span><span style="color: #666666">=10</span>, dx<span style="color: #666666">=0.01</span>):
        <span style="color: #BA2121; font-style: italic">&quot;&quot;&quot;</span>
<span style="color: #BA2121; font-style: italic">        A simple plotting routine for plotting f(x) in some range.</span>
<span style="color: #BA2121; font-style: italic">        &quot;&quot;&quot;</span>
        x <span style="color: #666666">=</span> np<span style="color: #666666">.</span>arange(<span style="color: #008000">min</span>, <span style="color: #008000">max</span>, dx)
        y <span style="color: #666666">=</span> <span style="color: #008000">self</span><span style="color: #666666">.</span>f(x)
        fig <span style="color: #666666">=</span> plt<span style="color: #666666">.</span>figure()
        plt<span style="color: #666666">.</span>plot(x, y)
        plt<span style="color: #666666">.</span>grid()
</pre></div>
<p>
Besides the initialization method and a function that calculates \( f(x) \) from
equation <a href="#mjx-eqn-1">(1)</a>, the class includes a simple plotting routine.
A major difference from before is the following: when our function \( f(x) \)
is defined inside a class, we do not have to pass around \( a \) and \( b \) as
arguments to the function <code>f</code>. Instead, we simply access \( a \) and \( b \) from
inside the class itself (using the <code>self</code>-prefix).
<!--  -->
<!-- both when referring to the variables / attributes, and as the first input -->
<!-- argument to the function. -->

<p>
Below is an example of how to use the class:
<p>

<!-- code=python (!bc pypro) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%; margin: 0;"><span></span><span style="color: #408080; font-style: italic"># Create two WavePacket objects, having their own parameter values</span>
WP1 <span style="color: #666666">=</span> WavePacket(<span style="color: #666666">0.1</span>, <span style="color: #666666">2</span>)  <span style="color: #408080; font-style: italic"># a=0.1, b=2</span>
WP2 <span style="color: #666666">=</span> WavePacket(<span style="color: #666666">0.1</span>, <span style="color: #666666">10</span>)  <span style="color: #408080; font-style: italic"># a = 0.1, b=10</span>

<span style="color: #408080; font-style: italic"># Evaluate the two functions at a specific point</span>
x <span style="color: #666666">=</span> <span style="color: #666666">1</span>
<span style="color: #008000">print</span>(WP1<span style="color: #666666">.</span>f(x))
<span style="color: #008000">print</span>(WP2<span style="color: #666666">.</span>f(x))

<span style="color: #408080; font-style: italic"># Plot the two functions</span>
WP1<span style="color: #666666">.</span>plot()
WP2<span style="color: #666666">.</span>plot()
</pre></div>
<p>
Although we had to write slightly more code, we hope you appreciate
how easy this makes running parallel simulations with different parameters!

<p>
<b>Part 1.</b>

<ul>
<li> Add another function (<a href="https://realpython.com/instance-class-and-static-methods-demystified/" target="_self">instance method</a>) to the class above called <code>df_fe</code>. This function should return the forward difference approximation to the derivative of the function <code>f</code> at a point <code>x</code> given as input. Include the step-size <code>h</code> as input argument (i.e., from the outside the class).</li>
<li> Add a second function, <code>df_cd</code>, which calculates the central difference approximation.</li>
</ul>

<b>Part 2.</b>

<ul>
<li> Make a third function inside the class that plots the absolute error versus step size for the two finite difference approximations. Use step sizes in the range from \( 10^{-16} \) to 1 (with logarithmic spacing).</li>
</ul>

Hint: You should re-use the first two functions when making the third one.

<h1 id="exer:isostasy" class="anchor">Exercise 4: A song of ice and fire?</h1>

<p>
There is currently a great deal of concern about global warming.
Some critical issues are whether we are more likely to observe
extreme local temperatures, increased frequencies of natural
disasters like forest fires and droughts, and if there are
"tipping points" in the climate system that are, at least on the
human timescale, irreversible <a href="#IPCC2021">[4]</a>.
One particular question to ask is: How much ice is likely to melt?
And, what would be the consequence of ice melting for sea level rise (SLR)?

<p>
Since most of the ice on Planet Earth is located in Antarctica, substantial
effort has been spent in mapping the ice and the bedrock of this continent.
Most of the data is freely available, and we can use them to investigate
different scenarios.

<p>
<div class="alert alert-block alert-success alert-text-normal"><b>Preparations for exercise: Install helpful Python packages</b>
We will work with the <em>bedmap2</em> dataset <a href="#fretwell2013bedmap2">[2]</a>.
The <a href="https://www.fatiando.org/rockhound/latest/" target="_self">rockhound</a>
library can be used to load the data.
As an aid to plotting, we will also employ color maps from the
<a href="https://pypi.org/project/cmocean/" target="_self">cmocean</a> library <a href="#thyng2016true">[5]</a>.
Therefore, you should start by making sure that you have both
cmocean and rockhound installed in the Python version that you
use.

<p>
To avoid potential problems down the road, it is recommended to work with
different <em>Python environments</em> on your computer, rather than a single global
installation.  To this end, you can use either
<a href="https://realpython.com/python-virtual-environments-a-primer/" target="_self"><tt>venv</tt></a>, or
(recommended for this course) the
<a href="https://conda.io/projects/conda/en/latest/user-guide/tasks/manage-environments.html" target="_self">conda package manager</a>.
In the following you should use the environment you created at the beginning of the project.
</div>


<h2 id="___sec7" class="anchor">Theory </h2>

<p>
To calculate SLR, we need to know not only how thick the ice is, but also
its elevation above the bedrock. In this exercise you will see how we can
use Python, together with available data and libraries, to do quite advanced
calculations.

<h3 id="___sec8" class="anchor">Melting of an iceberg </h3>

<p>
Let us start by deriving a result that you may have seen before.
We shall consider an iceberg that is floating and which is not impacted
by any other forces than gravity.
The total volume of ice
in figure <a href="#fig:iceberg">2</a> is \( V_f + V_\text{H2O}^\text{disp} \) ,
where \( V_f \) is the ice volume floating above the sea,
and \( V_\text{H2O}^\text{disp} \) is the
volume of displaced sea water (submerged ice).
According to Newton's 2nd law, the total weight of ice is therefore
$$
\begin{equation}
W=m_{ice}g = \rho_{ice}V_{ice}g
= \rho_{ice}(V_f + V_{\text{H$_2$O}}^\text{disp})g\,,
\tag{3}
\end{equation}
$$

where \( \rho_{ice} \) is the density (mass divided by volume),
and \( g=9.81 \text{m/s}^2 \) the gravitational constant.
On the other hand, the Archimedean principle tells us that buoyancy
is proportional to <em>the mass of displaced water</em>, hence another expression
for the same weight is
$$
\begin{equation}
\tag{4}
W = \rho_{w}V_{\text{H$_2$O}}^\text{disp}g\,,
\end{equation}
$$

where \( \rho_{w} \) is the density of the surrounding sea-water.
As the ice melts, it must be turned into an equal mass of liquid ice-water:
$$
\begin{align}
m_\text{ice} &= m_\text{ice water} \nonumber \\ 
\rho_\text{ice}V_\text{ice} &= \rho_\text{ice water}V_\text{ice water}\,.
\tag{5}
\end{align}
$$

<p>
By combining the above equations, we therefore get:

$$
\begin{equation}
\tag{6}
V_{\text{H$_2$O}}^\text{disp}=\frac{\rho_\text{ice water}}{\rho_{w}}V_\text{ice water}.
\end{equation}
$$

<p>
Therefore, the net contribution to SLR is captured by the volume change
$$
\begin{equation}
\Delta{V}\equiv V_\text{ice water}-V_{\text{H$_2$O}}^\text{disp}=
\left(1-\frac{\rho_\text{ice water}}{\rho_{w}}\right)V_\text{ice water}.
\tag{7}
\end{equation}
$$

<p>
If the melted ice has the same density as seawater, it follows that there
is <em>no increase in sea level</em>. On the other hand, if the density is
lower than that of seawater, there is a contribution.
Typically, the melting of ice dilutes the salinity of the ocean, which
leads to a small increase in sea level <a href="#noerdlinger2007melting">[6]</a>.

<p>
<center> <!-- figure label: --> <div id="fig:iceberg"></div> <!-- FIGURE -->
<hr class="figure">
<center><p class="caption">Figure 2:  A schematic illustration of an iceberg. \( V_{\mathrm{H_{2}O}}^{\mathrm{disp}} \) is the volume of water displaced by the iceberg.  <!-- caption label: fig:iceberg --> </p></center>
<p><img src="fig-project1/iceberg.png" align="bottom" width=800></p>
</center>

<h3 id="___sec9" class="anchor">Freeboard </h3>

<p>
The vast majority of ice in Antarctica is not freely floating.
In addition to the salinity effect described above, the main contribution
to SLR is from ice located above <em>hydrostatic equilibrium</em>.
It is useful to introduce the concept of the <em>freeboard</em>, which is the
height above seawater of a floating iceberg.
Again referring to figure <a href="#fig:iceberg">2</a>, the freeboard height, \( h \), is
$$
\begin{equation}
\tag{8}
h=\left(\frac{\rho_w}{\rho_\text{ice}}-1\right)h_w\,.
\end{equation}
$$

<p>
For the <em>bedmap2</em> dataset, the freeboard level can be computed
from (figure <a href="#fig:bedmap2_ice_thickness">3</a>)
$$
\begin{align}
\tag{9}
h = -(\text{surface}-\text{thickness})\cdot\left(\frac{\rho_w}{\rho_{ice}}-1\right)
\end{align}
$$

Note that this formula assumes
that the bedrock is below sea-level.

<p>
<b>Part 1.</b>

<p>
The code below is taken from the
<a href="https://www.fatiando.org/rockhound/latest/api/generated/rockhound.fetch_bedmap2.html" target="_self">rockound library documentation</a>:

<p>

<!-- code=python (!bc pypro) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%; margin: 0;"><span></span>bedmap <span style="color: #666666">=</span> rh<span style="color: #666666">.</span>fetch_bedmap2(datasets<span style="color: #666666">=</span>[<span style="color: #BA2121">&quot;thickness&quot;</span>,<span style="color: #BA2121">&quot;surface&quot;</span>,<span style="color: #BA2121">&quot;bed&quot;</span>])
plt<span style="color: #666666">.</span>figure(figsize<span style="color: #666666">=</span>(<span style="color: #666666">8</span>, <span style="color: #666666">7</span>))
ax <span style="color: #666666">=</span> plt<span style="color: #666666">.</span>subplot(<span style="color: #666666">111</span>)
bedmap<span style="color: #666666">.</span>surface<span style="color: #666666">.</span>plot<span style="color: #666666">.</span>pcolormesh(ax<span style="color: #666666">=</span>ax,cmap<span style="color: #666666">=</span>cmocean<span style="color: #666666">.</span>cm<span style="color: #666666">.</span>ice,
                       cbar_kwargs<span style="color: #666666">=</span><span style="color: #008000">dict</span>(pad<span style="color: #666666">=0.01</span>, aspect<span style="color: #666666">=30</span>))
plt<span style="color: #666666">.</span>title(<span style="color: #BA2121">&quot;Bedmap2 Antarctica&quot;</span>)
plt<span style="color: #666666">.</span>tight_layout()
plt<span style="color: #666666">.</span>show()
</pre></div>
<ul>
<li> Run the code and reproduce figure <a href="#fig:bedmap2_ice_thickness">3</a>.</li>
</ul>

<center> <!-- figure label: --> <div id="fig:bedmap2_ice_thickness"></div> <!-- FIGURE -->
<hr class="figure">
<center><p class="caption">Figure 3:  Visualization of the ice thickness in Antarctica.  <!-- caption label: fig:bedmap2_ice_thickness --> </p></center>
<p><img src="fig-project1/bedmap2_plot.png" align="bottom" width=800></p>
</center>

<p>
This may take quite some time, so it is recommended that you do not execute
the cell generating the plot more often than you have to.

<p>
<b>Part 2.</b>

<p>
The Thwaites glacier, named after Fredrik T. Thwaites, is of particular
interest. Also referred to as the Doomsday glacier, it is a fast moving
glacier (up to 4 km/year) at the coast of Antarctica, roughly 120 km wide.
It is called the Doomsday glacier because it is believed that it may trigger
a <a href="https://interactive.pri.org/2019/05/antarctica/doomed-glacier-race.html" target="_self">collapse of west Antarctica</a>.
We can use the bedmap2 dataset to view a cross section of the glacier,
\( y = -0.5\cdot10^{6} \) and \( x\in[-1.6\cdot10^6,-1.35\cdot 10^6] \):

<p>

<!-- code=python (!bc pypro) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%; margin: 0;"><span></span><span style="color: #408080; font-style: italic"># Extract cross section using the original coordinates</span>
bed1d <span style="color: #666666">=</span> bedmap<span style="color: #666666">.</span>sel(y<span style="color: #666666">=-0.5e6</span>, x<span style="color: #666666">=</span><span style="color: #008000">slice</span>(<span style="color: #666666">-1.6e6</span>,<span style="color: #666666">-1.35e6</span>))

<span style="color: #408080; font-style: italic"># Add a second x-coordinate to make prettier plots</span>
<span style="color: #408080; font-style: italic"># (shift x-axis to start at zero, and convert from m to km)</span>
bed1d <span style="color: #666666">=</span> bed1d<span style="color: #666666">.</span>assign_coords({<span style="color: #BA2121">&quot;x2&quot;</span>:((bed1d<span style="color: #666666">.</span>x<span style="color: #666666">+1.6e6</span>)<span style="color: #666666">/1e3</span>)})
</pre></div>
<p>
It is now possible to plot the values in the <code>bed1d</code> data array by simply
typing
<p>

<!-- code=python (!bc pypro) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%; margin: 0;"><span></span>bed1d<span style="color: #666666">.</span>surface<span style="color: #666666">.</span>plot(x<span style="color: #666666">=</span><span style="color: #BA2121">&#39;x2&#39;</span>)
</pre></div>
<p>
<div class="alert alert-block alert-success alert-text-normal"><b>A note concerning the xarray library</b>
The <em>bedmap2</em> data is stored in data structures provided by the
<a href="http://xarray.pydata.org/en/stable/" target="_self">xarray</a> package, which is built on
top of <a href="https://numpy.org" target="_self">NumPy</a> and <a href="https://pandas.pydata.org" target="_self">pandas</a>.
While xarray allows you to apply plot commands directly to
<a href="http://xarray.pydata.org/en/stable/generated/xarray.Dataset.html#xarray.Dataset" target="_self">Datasets</a>
and <a href="http://xarray.pydata.org/en/stable/generated/xarray.DataArray.html#xarray.DataArray" target="_self">DataArrays</a>,
it might be easier to use the <code>matplotlib.pyplot</code> module manually.
To this end, you might also want to extract the underlying NumPy arrays
containing the data you are interested in. This can easily be done as in
the following example: <code>surface_elevation_values = bed1d['surface'].values</code>.
</div>


<ul>
<li> Use equation <a href="#mjx-eqn-9">(9)</a> to calculate the freeboard level.</li>
<li> Make a cross section plot of the ice thickness, bed rock, and freeboard level, similar to (the right) figure (<a href="#fig:cross">4</a>)</li>
<li> Explain what you see. Is the shape of the bedrock important for sea level rise?</li>
</ul>

<center> <!-- figure label: --> <div id="fig:cross"></div> <!-- FIGURE -->
<hr class="figure">
<center><p class="caption">Figure 4:  (left) How to calculate the freeboard level. (right) Cross section plot of Thwaites glacier.  <!-- caption label: fig:cross --> </p></center>
<p><img src="fig-project1/free_cross.png" align="bottom" width=800></p>
</center>

<p>
<b>Part 3.</b>

<ul>
<li> Use the whole data set to estimate the total SLR if all the ice of Antarctica melts.</li>
</ul>

Hints to get you started:

<ol>
<li> Start by calculating, for each grid cell in the dataset, the height of ice that can contribute to SLR.</li>
<li> Multiply the height with the area of each cell (\( 1000\times1000 \) meters) in order to estimate the volume of ice.</li>
</ol>

<b>Part 4.</b>

<ul>
<li> How can we use the bedmap data to improve decision making?</li>
<li> What are some limitations in your estimated calculation of sea level rise?</li>
</ul>

<h1 id="___sec10" class="anchor">Appendix A: Package management with <code>conda</code> </h1>

<p>
Package installation in Python can be quite tricky, and it is easy
to make mistakes, especially if the packages you wish to use have
many dependencies. A good way of avoiding unnecessary installation problems
is to work with <em>virtual environments</em>; isolated installations of
Python on your computer. This allows you to switch between different Python
versions depending on the needs of a particular project.
We prefer to use the <a href="https://docs.conda.io/en/latest/" target="_self"><tt>conda</tt></a>
package manager that follows along with the
 <a href="https://www.anaconda.com" target="_self">Anaconda</a> Python distribution.

<h2 id="___sec11" class="anchor">Getting <code>conda</code> up and running </h2>

<p>
It is possible to use a graphical user interface (GUI) to work
with <code>conda</code>, but we will work exclusively from the command line.
On Windows, this will probably require some additional setup, to
make the relevant file paths available to <code>cmd.exe</code>.
Alternatively, you can use the Anaconda Prompt that comes with
the Anaconda distribution.
To get started, it is recommended to check out the official
<a href="https://docs.anaconda.com/anaconda/user-guide/" target="_self">user guide</a>,
as well as <a href="https://conda.io/projects/conda/en/latest/user-guide/cheatsheet.html" target="_self">cheat sheets</a>
with an overview of the most frequently used commands.

<p>
Assuming that you have <code>conda</code> installed and available to you from the
terminal, typing the following command should report back the version
number of <code>conda</code> on your system:

<p>

<!-- code=text typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%; margin: 0;"><span></span>conda --version
</pre></div>
<p>
If everything works, you will get something like this as output:

<p>

<!-- code=text typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%; margin: 0;"><span></span>conda 4.10.3
</pre></div>
<p>
You can list all of your available conda environments by typing:

<p>

<!-- code=text typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%; margin: 0;"><span></span>conda info --envs
</pre></div>
<p>
A star asterisk points to the currently active environment.
For a fresh Anaconda installation, you will only have one, the base
environment.
You can find out exactly which packages that belongs to this
environment by writing

<p>

<!-- code=text typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%; margin: 0;"><span></span>conda list
</pre></div>

<h2 id="___sec12" class="anchor">Creating virtual environments </h2>

<p>
It is now very easy to create your own, custom Python environment, e.g.:

<p>

<!-- code=text typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%; margin: 0;"><span></span>conda create --name MyExampleEnv python=3.9 numpy scipy matplotlib
</pre></div>
<p>
As you might have guessed, we just created an environment with the name
MyExampleEnv, along the way installing version <code>3.9</code> of <code>python.exe</code> into it,
as well as several libraries we wish to use.
This will require you to answer a query on the command line, after which the
installation should commence.

<p>
We can activate the environment as follows:
<p>

<!-- code=text typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%; margin: 0;"><span></span>conda activate MyExampleEnv
</pre></div>
<p>
Additional packages can be installed later as needed, you just have to
remember to activate the environment first (if it has not been done already),
e.g.:
<p>

<!-- code=text typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%; margin: 0;"><span></span>conda activate MyExampleEnv
conda install pandas jupyter
</pre></div>
<p>
You can verify that <code>pandas</code> and <code>jupyter</code> have been installed by again
typing <code>conda list</code> in the terminal.

<p>
Many packages will be possible to install exactly as above; or possibly
by adding a few additional steps. For example, the <code>cmocean</code> and
<code>rockhound</code>. packages can be installed as follows:
<p>

<!-- code=python (!bc pypro) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%; margin: 0;"><span></span>conda activate MyExampleEnv
conda install <span style="color: #666666">-</span>c conda<span style="color: #666666">-</span>forge cmocean
conda install rockhound <span style="color: #666666">--</span>channel conda<span style="color: #666666">-</span>forge
</pre></div>
<p>
As always, you should check the installation instructions provided
together with the package!

<h2 id="___sec13" class="anchor">Selecting the version of Python to use </h2>

<p>
Each conda environment comes with its own installation directory,
and with its own Python executable.
If you program in an integrated development environment (IDE), like Spyder
or Visual Studio Code, you will typically be able to choose the Python version
to use by changing the project preferences.
On the command-line, you can switch between different environments via
the <code>conda activate</code> command.

<p>
When working with Jupyter notebooks, it may require some additional
effort to be able to use your own environments.
By <a href="https://stackoverflow.com/questions/39604271/conda-environments-not-showing-up-in-jupyter-notebook" target="_self">writing</a>
<p>

<!-- code=text typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%; margin: 0;"><span></span>conda activate MyExampleEnv
python -m ipykernel install --name MyExampleEnv
</pre></div>
<p>
the <code>conda</code> environment MyExampleEnv will show up as a possible Python kernel
for your Jupyter notebooks.

<h1 id="___sec14" class="anchor">Appendix B: Some intermediate Python tips </h1>

<p>
If you want to make your code more elegant, it is very useful to
learn about
<a href="https://dbader.org/blog/python-dunder-methods" target="_self">special functions</a>
besides <code>__init__</code>.
When working with mathematical functions, the <code>__call__</code> function is
particularly useful.  Again, this is best understood via an example,
a simple modification of the class we suggested in the main text:
<p>

<!-- code=python (!bc pypro) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%; margin: 0;"><span></span><span style="color: #008000; font-weight: bold">class</span> <span style="color: #0000FF; font-weight: bold">WavePacket</span>:
    <span style="color: #BA2121; font-style: italic">&quot;&quot;&quot;</span>
<span style="color: #BA2121; font-style: italic">    An updated class representation of a wave packet-function.</span>
<span style="color: #BA2121; font-style: italic">    &quot;&quot;&quot;</span>
    <span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">__init__</span>(<span style="color: #008000">self</span>, a, b):
        <span style="color: #008000">self</span><span style="color: #666666">.</span>a <span style="color: #666666">=</span> a
        <span style="color: #008000">self</span><span style="color: #666666">.</span>b <span style="color: #666666">=</span> b

    <span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">__call__</span>(<span style="color: #008000">self</span>, x):
        <span style="color: #008000; font-weight: bold">return</span> np<span style="color: #666666">.</span>sin(<span style="color: #008000">self</span><span style="color: #666666">.</span>b<span style="color: #666666">*</span>x)<span style="color: #666666">*</span>np<span style="color: #666666">.</span>exp(<span style="color: #666666">-</span><span style="color: #008000">self</span><span style="color: #666666">.</span>a<span style="color: #666666">*</span>x<span style="color: #666666">*</span>x)

    <span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">plot</span>(<span style="color: #008000">self</span>, <span style="color: #008000">min</span><span style="color: #666666">=-10</span>, <span style="color: #008000">max</span><span style="color: #666666">=10</span>, dx<span style="color: #666666">=0.01</span>):
        <span style="color: #BA2121; font-style: italic">&quot;&quot;&quot;</span>
<span style="color: #BA2121; font-style: italic">        A simple plotting routine for plotting f(x) in some range.</span>
<span style="color: #BA2121; font-style: italic">        &quot;&quot;&quot;</span>
        x <span style="color: #666666">=</span> np<span style="color: #666666">.</span>arange(<span style="color: #008000">min</span>, <span style="color: #008000">max</span>, dx)
        y <span style="color: #666666">=</span> <span style="color: #008000">self</span><span style="color: #666666">.</span><span style="color: #0000FF">__call__</span>(x)
        fig <span style="color: #666666">=</span> plt<span style="color: #666666">.</span>figure()
        plt<span style="color: #666666">.</span>plot(x, y)
        plt<span style="color: #666666">.</span>grid()
</pre></div>
<p>
We have simply replaced the original function <code>f</code> with <code>__call__</code>.
This allows us to treat objects of the class <code>WavePacket</code> as if they
are ordinary functions:
<p>

<!-- code=python (!bc pypro) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%; margin: 0;"><span></span>WP1 <span style="color: #666666">=</span> WavePacket(<span style="color: #666666">0.1</span>, <span style="color: #666666">2</span>)
WP1(<span style="color: #666666">1.0</span>)  <span style="color: #408080; font-style: italic"># Evaluates the function at x=1.0</span>
</pre></div>
<p>
Similarly, the <code>__str__</code>-function allows you to send your custom-made objects
to the <code>print</code> statement, e.g:

<p>

<!-- code=python (!bc pypro) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%; margin: 0;"><span></span><span style="color: #008000; font-weight: bold">class</span> <span style="color: #0000FF; font-weight: bold">WavePacket</span>:

    <span style="color: #666666">...</span>

    <span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">__str__</span>(<span style="color: #008000">self</span>):
        <span style="color: #BA2121; font-style: italic">&quot;&quot;&quot;</span>
<span style="color: #BA2121; font-style: italic">        :return: A string representation of the function</span>
<span style="color: #BA2121; font-style: italic">                (NB: uses LaTeX).</span>
<span style="color: #BA2121; font-style: italic">        &quot;&quot;&quot;</span>
        <span style="color: #008000; font-weight: bold">return</span> <span style="color: #BA2121">f&#39;sin(</span><span style="color: #BB6688; font-weight: bold">{</span><span style="color: #008000">self</span><span style="color: #666666">.</span>b<span style="color: #BB6688; font-weight: bold">}</span><span style="color: #BA2121">x)&#39;</span> <span style="color: #666666">+</span> <span style="color: #BA2121">r&#39;$\cdot$&#39;</span> \ 
                                 <span style="color: #666666">+</span> <span style="color: #BA2121">f&#39;exp(-</span><span style="color: #BB6688; font-weight: bold">{</span><span style="color: #008000">self</span><span style="color: #666666">.</span>a<span style="color: #BB6688; font-weight: bold">}</span><span style="color: #BA2121">&#39;</span><span style="color: #666666">+</span> <span style="color: #BA2121">r&#39;$x^2$)&#39;</span>
</pre></div>
<p>

<!-- code=python (!bc pypro) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%; margin: 0;"><span></span>wave_func <span style="color: #666666">=</span> WavePacket(<span style="color: #666666">0.1</span>, <span style="color: #666666">5.0</span>)
<span style="color: #008000">print</span>(wave_func)
</pre></div>

<h1 id="___sec15" class="anchor">Guidelines for project submission </h1>

<p>
You should bear the following points in mind when working on the project:

<ul>
<li> Start your notebook by providing a short introduction in which you outline the nature of the problem(s) to be investigated.</li>
<li> End your notebook with a brief summary of what you feel you learned from the project (if anything). Also, if you have any general comments or suggestions for what could be improved in future assignments, this is the place to do it.</li>
<li> All code that you make use of should be present in the notebook, and it should ideally execute without any errors (especially run-time errors). If you are not able to fix everything before the deadline, you should give your best understanding of what is not working, and how you might go about fixing it.</li>
<li> Avoid duplicating code! If you find yourself copying and pasting a lot of code, it is a strong indication that you should define reuseable functions and/or classes.</li>
<li> If you use an algorithm that is not fully described in the assignment text, you should try to explain it in your own words. This also applies if the method is described elsewhere in the course material.</li>
<li> In some cases it may suffice to explain your work via comments in the code itself, but other times you might want to include a more elaborate explanation in terms of, e.g., mathematics and/or pseudocode.</li>
<li> In general, it is a good habit to comment your code (though it can be overdone).</li>
<li> When working with approximate solutions to equations, it is very useful to check your results against known exact (analytical) solutions, should they be available.</li>
<li> It is also a good test of a model implementation to study what happens at known 'edge cases'.</li>
<li> Any figures you include should be easily understandable. You should label axes appropriately, and depending on the problem, include other legends etc. Also, you should discuss your figures in the main text.</li>
<li> It is always good if you can reflect a little bit around <em>why</em> you see what you see.</li>
</ul>

<h1 id="___sec16" class="anchor">Bibliography </h1>

<p>
<!-- begin bibliography -->

<ol>
 <li> <div id="goldberg1991every"></div> <b>D. Goldberg</b>. 
    What Every Computer Scientist Should Know About Floating-Point Arithmetic,
    <em>ACM computing surveys (CSUR)</em>,
    23(1),
    pp. 5-48,
    1991.</li>
 <li> <div id="fretwell2013bedmap2"></div> <b>P. Fretwell, H. D. Pritchard, D. G. Vaughan, J. L. Bamber, N. E. Barrand, R. Bell, C. Bianchi, R. Bingham, D. D. Blankenship and G. Casassa</b>. 
    Bedmap2: Improved Ice Bed, Surface and Thickness Datasets for Antarctica,
    <em>The Cryosphere</em>,
    7(1),
    pp. 375-393,
    2013.</li>
 <li> <div id="hiorth"></div> <b>A. Hiorth</b>. 
    <em>Computational Engineering and Modeling</em>,
    https://github.com/ahiorth/CompEngineering,
    2021.</li>
 <li> <div id="IPCC2021"></div> <b>V. Masson-Delmotte, P. Zhai, A. Pirani, S. L. Connors, C. Pean, S. Berger, N. Caud, Y. Chen, L. Goldfarb, M. I. Gomis, M. Huang, K. Leitzell, E. Lonnoy, J. B. R. Matthews, T. K. Maycock, T. Waterfield, O. Yelekci, R. Yu and B. Z. (eds.)</b>. 
    Climate Change 2021: the Physical Science Basis. Contribution of Working Group I to the Sixth Assessment Report of the Intergovernmental Panel on Climate Change,
    <em>Cambridge University Press. In Press.</em>,
    2021.</li>
 <li> <div id="thyng2016true"></div> <b>K. M. Thyng, C. A. Greene, R. D. Hetland, H. M. Zimmerle and S. F. DiMarco</b>. 
    True Colors of Oceanography: Guidelines for Effective and Accurate Colormap Selection,
    <em>Oceanography</em>,
    29(3),
    pp. 9-13,
    2016.</li>
 <li> <div id="noerdlinger2007melting"></div> <b>P. D. Noerdlinger and K. R. Brower</b>. 
    The Melting of Floating Ice Raises the Ocean Level,
    <em>Geophysical Journal International</em>,
    170(1),
    pp. 145-150,
    2007.</li>
</ol>

<!-- end bibliography -->

<p>
<!-- navigation buttons at the bottom of the page -->
<ul class="pager">
</ul>
<!-- ------------------- end of main content --------------- -->

</div>  <!-- end container -->
<!-- include javascript, jQuery *first* -->
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>
<script src="https://netdna.bootstrapcdn.com/bootstrap/3.0.0/js/bootstrap.min.js"></script>

<!-- Bootstrap footer
<footer>
<a href="http://..."><img width="250" align=right src="http://..."></a>
</footer>
-->


</body>
</html>
    

