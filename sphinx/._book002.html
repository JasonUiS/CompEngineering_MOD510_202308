
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" lang="1.0">
  <head>
    <meta charset="utf-8" />
    <title>Writing Python code &#8212; _ Aksel Hiorth, the National IOR Centre &amp; Institute for Energy Resources, University of Stavanger documentation</title>
    <link rel="stylesheet" href="_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/graphviz.css" />
    <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="_static/language_data.js"></script>
    <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Finite differences" href="._book003.html" />
    <link rel="prev" title="Preface" href="._book001.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  
       <style type="text/css">
         div.admonition {
           background-color: whiteSmoke;
           border: 1px solid #bababa;
         }
       </style>
      </head>
    <body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <div class="section" id="writing-python-code">
<span id="ch-pyt"></span><h1>Writing Python code<a class="headerlink" href="#writing-python-code" title="Permalink to this headline">¶</a></h1>
<p>In this chapter we cover some aspects of how to write (good) Python code. As you might have discovered tasks can be solved in many different ways in Python. This is clearly a strength because you would most likely be able to solve any task thrown at you. On the other hand it is a weakness, because code can get messy and hard to follow, especially if you solve the same task in different part of your code using different libraries or syntax.</p>
<p>In this chapter I will explain how I tend to solve some common tasks, in this process we will also cover some stuff that you should know. If you need more information on each topic below, there are plenty of online sources.</p>
<p>The code examples are meant as an inspiration, and maybe you do not agree and have solutions that you think are much better. If that is the case I would love to know, and I can update this chapter.</p>
<div class="admonition-speed-and-readability admonition">
<p class="admonition-title">Speed and readability</p>
<p>Many people are concerned about speed or execution time. My advice is to focus on readable code, and get the job done. When the code is working it is very easy to go back and change out parts that are slow. Particularly you can use the magic commands <code class="docutils literal notranslate"><span class="pre">%timeit</span></code> to check performance of different functions. There is also the option of using <a class="reference external" href="https://numba.pydata.org/">Numba</a>, which translate python code into optimized machine code.</p>
</div>
<div class="section" id="personal-guidelines">
<h2>Personal Guidelines<a class="headerlink" href="#personal-guidelines" title="Permalink to this headline">¶</a></h2>
<p>It is important to have a some guidelines when coding, and for Python there are clear style guides <a class="reference external" href="https://www.python.org/dev/peps/pep-0008/">PEP 8</a>. Take a look at the official guidelines, and  make some specific rules for yourself, and stick to them. The reason for this is that if you make a large code, people will recognize your style and it is easier to understand the code. If you are working in team, it is even more important - try to agree on some basic rules, e.g.</p>
<p><strong>Code Guidelines:</strong>
* Variable names should be meaningful</p>
<ul class="simple">
<li><p>Naming of variables and functions, should you write <code class="docutils literal notranslate"><span class="pre">def</span> <span class="pre">my_fynction(...):</span></code> or <code class="docutils literal notranslate"><span class="pre">def</span> <span class="pre">MyFunction(..)</span></code>, i.e are words separated by underscore or capital letter. Personally I use capital letters for class definition, and underscore for function definitions.</p></li>
<li><p>(Almost) always use doc string, you would be amazed how easy it is to forget what a function does. Shorter (private) functions usually do not need comments or doc strings, <em>if you use good variable names</em> - it should then be easy to understand what is happening by just looking at the code.</p></li>
<li><p>Inline comments should be used sparingly, only where strictly necessary.</p></li>
<li><p>Strive to make code general, in particular not type specific. In Python it is easy to make functions that will work if a list (array) or a single value is passed.</p></li>
<li><p>Use exception handling, in particular for larger projects.</p></li>
<li><p>DRY - Do not Repeat Yourself <span id="id1">[Ref1]</span>. If you need to change the code more than one place to extend it, you will forget.</p></li>
<li><p>The DRY principle also applies to <em>knowledge sharing</em>, it is not only about copy and paste line of code, but knowledge should only be represented in one place.</p></li>
<li><p>Import libraries using the syntax <code class="docutils literal notranslate"><span class="pre">import</span> <span class="pre">library</span> <span class="pre">as</span> <span class="pre">..</span></code>, Numpy would typically be <code class="docutils literal notranslate"><span class="pre">import</span> <span class="pre">numpy</span> <span class="pre">as</span> <span class="pre">np</span></code>. The syntax <code class="docutils literal notranslate"><span class="pre">from</span> <span class="pre">numpy</span> <span class="pre">import</span> <span class="pre">*</span></code> could lead to conflicts between modules as functions could have the same name in two different modules.</p></li>
</ul>
<p><strong>Work Guidelines:</strong>
* Do not copy and paste code without understanding it. It is OK to be inspired of others, but in some cases the code example are unnecessary complicates, but perhaps more important you will get a code with a mix of different styles.</p>
<ul class="simple">
<li><p>Stick to a limited number of libraries, I try to do as much as possible with <a class="reference external" href="https://numpy.org/">Numpy</a>, <a class="reference external" href="https://pandas.pydata.org/">Pandas</a>, and  <a class="reference external" href="https://matplotlib.org/">Matplotlib</a>. I only do plotting with Matplotlib, and do not use the build in functionality of Pandas.</p></li>
<li><p>Unexpected behavior of functions, functions should be able to discover if something are wrong with arguments, and give warnings.</p></li>
</ul>
<div class="section" id="code-editor">
<h3>Code editor<a class="headerlink" href="#code-editor" title="Permalink to this headline">¶</a></h3>
<p>You would like to use an editor that gives you some help. It is particularly useful when you do not remember a variable or function name, you can guess at the name and a drop down list will appear which will let you pick the name or function you want. If you enter  a function name, the editor will write some useful information about the function, some screenshots are shown in figure <a class="reference internal" href="#fig-py-vscode"><span class="std std-ref">A screenshot of vscode (left) the editor helps to identify which variable name you mean, (right) the editor show relevant of the function you would like to call</span></a>.</p>
<div class="figure align-default" id="id2">
<span id="fig-py-vscode"></span><a class="reference internal image-reference" href="_images/vscode.png"><img alt="_images/vscode.png" src="_images/vscode.png" style="width: 400px;" /></a>
<p class="caption"><span class="caption-text"><em>A screenshot of vscode (left) the editor helps to identify which variable name you mean, (right) the editor show relevant of the function you would like to call</em></span><a class="headerlink" href="#id2" title="Permalink to this image">¶</a></p>
</div>
<p>Currently my favorite editor is <a class="reference external" href="https://code.visualstudio.com/">vscode</a>, it can be used for any language, and there are a lot of add ins that can be installed to make the coding experience more pleasant. Spyder is also a very good alternative, but this editor is mainly for Python. It takes some time to learn how an editor work, so it is good if it can be used for multiple purposes.  However, always be open to new ideas and products, it will only make you more efficient. As an example, in some cases you will have a particular difficult error in the code, and then it could help to open and run that code in a different editor, you might get a slightly different error messages, which could help you locate the error.</p>
</div>
</div>
<div class="section" id="types-in-python">
<h2>Types in Python<a class="headerlink" href="#types-in-python" title="Permalink to this headline">¶</a></h2>
<p id="index-0">In Python you do not need to define types as in a compiled language, this an advantage as you need to do less writing, and it is also easier to create functions that will work with any kind of type.</p>
<div class="section" id="basic-types">
<h3>Basic types<a class="headerlink" href="#basic-types" title="Permalink to this headline">¶</a></h3>
<p id="index-1">I will assume that you are familiar with the common types like floats (for real numbers), strings (text, lines, word, a character), integer (whole numbers), Boolean (True, False). What is sometimes useful is to be able to test what kind of type a variable is, this can be done with <code class="docutils literal notranslate"><span class="pre">type()</span></code></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">my_float</span> <span class="o">=</span> <span class="mf">2.0</span>
<span class="n">my_int</span>   <span class="o">=</span> <span class="mi">3</span>
<span class="n">my_bool</span>  <span class="o">=</span> <span class="kc">True</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">my_float</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">my_int</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">my_bool</span><span class="p">))</span>
</pre></div>
</div>
<p>The output of the code above will be <code class="docutils literal notranslate"><span class="pre">float,</span> <span class="pre">int,</span> <span class="pre">bool</span></code>. If you want to test the value of a variable you can do</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">my_int</span><span class="p">,</span><span class="nb">int</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;My variable is integer&#39;</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;My variable is not integer&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Python also has build in support for complex number, they are written <code class="docutils literal notranslate"><span class="pre">1+2j</span></code>, <code class="docutils literal notranslate"><span class="pre">j</span></code> is used as the complex number. Note there is no multiplication between the number 2 and <code class="docutils literal notranslate"><span class="pre">j</span></code>.</p>
</div>
<div class="section" id="lists">
<h3>Lists<a class="headerlink" href="#lists" title="Permalink to this headline">¶</a></h3>
<span class="target" id="index-2"></span><p id="index-3">Lists are extremely useful, and they have some very nice syntax that in my mind is more elegant than Numpy arrays. Whenever you want to do more than one thing with only a slight change, you should think of lists. Lists are defined using the square bracket <code class="docutils literal notranslate"><span class="pre">[]</span></code> symbols</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">my_list</span> <span class="o">=</span> <span class="p">[]</span>      <span class="c1"># an empty list</span>
<span class="n">my_list</span> <span class="o">=</span> <span class="p">[]</span><span class="o">*</span><span class="mi">10</span>   <span class="c1"># still an empty list ...</span>
<span class="n">my_list</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="mi">10</span>  <span class="c1"># a list with 10 zeros</span>
<span class="n">my_list</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;one&#39;</span><span class="p">,</span> <span class="s1">&#39;two&#39;</span><span class="p">,</span><span class="s1">&#39;three&#39;</span><span class="p">]</span> <span class="c1"># a list of strings</span>
<span class="n">my_list</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;one&#39;</span><span class="p">]</span><span class="o">*</span><span class="mi">10</span> <span class="c1"># a list with 10 equal string elements</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>To get the first element in a list, we do e.g. <code class="docutils literal notranslate"><span class="pre">my_list[0]</span></code>. In a list with 10 elements the last element would be <code class="docutils literal notranslate"><span class="pre">my_list[9]</span></code>, the length of a list can be found by using the <code class="docutils literal notranslate"><span class="pre">len()</span></code> function, i.e. <code class="docutils literal notranslate"><span class="pre">len(my_list)=10</span></code>. Thus, the last element can also be found by doing <code class="docutils literal notranslate"><span class="pre">my_list[len(my_list)-1]</span></code>. However, in Python you can always get the last element by doing <code class="docutils literal notranslate"><span class="pre">my_list[-1]</span></code>, the second last element would be <code class="docutils literal notranslate"><span class="pre">my_list[-2]</span></code> and so on.</p>
</div>
<p>Sometimes you do not want to initialize the list with everything equal, and it can be tiresome to write everything out yourself. If that is the case you can use <em>list comprehension</em></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">my_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">)]</span> <span class="c1"># a list from 0,1,..,9</span>
<span class="n">my_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span><span class="o">**</span><span class="mi">3</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">)]</span> <span class="c1"># a list with elements 0,1,8, ..,729</span>
</pre></div>
</div>
<p>We will cover for loop below, but basically what is done is that the statement <code class="docutils literal notranslate"><span class="pre">i</span> <span class="pre">in</span> <span class="pre">range(10)</span></code>, gives <code class="docutils literal notranslate"><span class="pre">i</span></code> the value 0, 1, <span class="math notranslate nohighlight">\(\ldots\)</span>, 9 and the first <code class="docutils literal notranslate"><span class="pre">i</span></code> inside the list tells python to use that value as the element in the list. Using this syntax, there are plenty of opportunities to initialize. Maybe you want to pick from a list words that contain a particular subset of characters</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">my_list</span>  <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;hammer&#39;</span><span class="p">,</span> <span class="s1">&#39;nail&#39;</span><span class="p">,</span><span class="s1">&#39;saw&#39;</span><span class="p">,</span><span class="s1">&#39;lipstick&#39;</span><span class="p">,</span><span class="s1">&#39;shirt&#39;</span><span class="p">]</span>
<span class="n">new_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">my_list</span> <span class="k">if</span> <span class="s1">&#39;a&#39;</span> <span class="ow">in</span> <span class="n">i</span><span class="p">]</span>
</pre></div>
</div>
<p>Now <code class="docutils literal notranslate"><span class="pre">new_list=['hammer',</span> <span class="pre">'nail',</span> <span class="pre">'saw']</span></code>.
List arithmetic
~~~~~~~~~~~~~~~</p>
<p>I showed you some examples above, where we used multiplication to create a list with equal copies of a single element, you can also join two lists by using addition</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">my_list</span>  <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;hammer&#39;</span><span class="p">,</span><span class="s1">&#39;saw&#39;</span><span class="p">]</span>
<span class="n">my_list2</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;screw&#39;</span><span class="p">,</span><span class="s1">&#39;nail&#39;</span><span class="p">,</span><span class="s1">&#39;glue&#39;</span><span class="p">]</span>
<span class="n">new_list</span> <span class="o">=</span> <span class="n">my_list</span> <span class="o">+</span> <span class="n">my_list2</span>
</pre></div>
</div>
<p>Now <code class="docutils literal notranslate"><span class="pre">new_list=['hammer',</span> <span class="pre">'saw',</span> <span class="pre">'screw',</span> <span class="pre">'nail',</span> <span class="pre">'glue']</span></code>, we can also multiply the list with an integer and get a larger list with several copies of the original list.</p>
<div class="section" id="list-slicing">
<h4>List slicing<a class="headerlink" href="#list-slicing" title="Permalink to this headline">¶</a></h4>
<p>Clearly we can access elements in a list by using the index to the element, i.e. first element is <code class="docutils literal notranslate"><span class="pre">my_list[0]</span></code>, and the last element is <code class="docutils literal notranslate"><span class="pre">my_list[-1]</span></code>. Python also has very nice syntax to pick out a subset of a list. The syntax is <code class="docutils literal notranslate"><span class="pre">my_list[start:stop:step]</span></code>, the step makes it possible to skip elements</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">my_list</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;hammer&#39;</span><span class="p">,</span> <span class="s1">&#39;saw&#39;</span><span class="p">,</span> <span class="s1">&#39;screw&#39;</span><span class="p">,</span> <span class="s1">&#39;nail&#39;</span><span class="p">,</span> <span class="s1">&#39;glue&#39;</span><span class="p">]</span>
<span class="n">my_list</span><span class="p">[:]</span>      <span class="c1"># [&#39;hammer&#39;, &#39;saw&#39;, &#39;screw&#39;, &#39;nail&#39;, &#39;glue&#39;]</span>
<span class="n">my_list</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>     <span class="c1"># [&#39;saw&#39;, &#39;screw&#39;, &#39;nail&#39;, &#39;glue&#39;]</span>
<span class="n">my_list</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>    <span class="c1"># [&#39;hammer&#39;, &#39;saw&#39;, &#39;screw&#39;, &#39;nail&#39;]</span>
<span class="n">my_list</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>   <span class="c1"># [&#39;saw&#39;, &#39;screw&#39;, &#39;nail&#39;]</span>
<span class="n">my_list</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">]</span> <span class="c1"># [&#39;saw&#39;,&#39;nail&#39;]</span>
<span class="n">my_list</span><span class="p">[::</span><span class="mi">1</span><span class="p">]</span>    <span class="c1"># [&#39;hammer&#39;, &#39;saw&#39;, &#39;screw&#39;, &#39;nail&#39;, &#39;glue&#39;]</span>
<span class="n">my_list</span><span class="p">[::</span><span class="mi">2</span><span class="p">]</span>    <span class="c1"># [&#39;hammer&#39;, &#39;screw&#39;, &#39;glue&#39;]</span>
</pre></div>
</div>
<p>Sometimes you have lists of lists, if you want to get e.g. the first element of each list you cannot access those elements using list slicing, you have to use a for loop or list comprehension</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">my_list</span>  <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;hammer&#39;</span><span class="p">,</span><span class="s1">&#39;saw&#39;</span><span class="p">]</span>
<span class="n">my_list2</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;screw&#39;</span><span class="p">,</span><span class="s1">&#39;nail&#39;</span><span class="p">,</span><span class="s1">&#39;glue&#39;</span><span class="p">]</span>
<span class="n">new_list</span><span class="o">=</span><span class="p">[</span><span class="n">my_list</span><span class="p">,</span><span class="n">my_list2</span><span class="p">]</span>
<span class="c1"># extract the first element of each list</span>
<span class="n">new_list2</span> <span class="o">=</span> <span class="p">[</span> <span class="nb">list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="nb">list</span> <span class="ow">in</span> <span class="n">new_list</span><span class="p">]</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">new_list2=['hammer','screw']</span></code></p>
<div class="admonition-when-to-use-lists admonition">
<p class="admonition-title">When to use lists</p>
<p>Use lists if you have mixed types, and as storage containers. Be careful when you do numerical computation to mix lists and Numpy arrays, adding two lists e.g. <code class="docutils literal notranslate"><span class="pre">[1,2]+[1,1]</span></code>, will give you <code class="docutils literal notranslate"><span class="pre">[1,2,1,1]</span></code>, whereas adding two Numpy arrays will give you <code class="docutils literal notranslate"><span class="pre">[2,3]</span></code>.</p>
</div>
</div>
</div>
<div class="section" id="numpy-arrays">
<h3>Numpy arrays<a class="headerlink" href="#numpy-arrays" title="Permalink to this headline">¶</a></h3>
<p>Numpy arrays are awesome, and should be your preferred choice when doing numerical operations. We import Numpy as <code class="docutils literal notranslate"><span class="pre">import</span> <span class="pre">numpy</span> <span class="pre">as</span> <span class="pre">np</span></code>, some examples of initialization</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">my_array</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span> <span class="c1"># initialized from list</span>
<span class="n">my_array</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span> <span class="c1"># array with 10 elements equal to zero</span>
<span class="n">my_array</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>  <span class="c1"># array with 10 elements equal to one</span>
</pre></div>
</div>
<p>A typical use of Numpy arrays is when you want to create equal spaced numbers to evaluate a function, this can be done in (at least) two ways</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">my_array</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mf">0.2</span><span class="p">)</span> <span class="c1"># [0, 0.2, 0.4, 0.6, 0.8]</span>
<span class="n">my_array</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span> <span class="c1"># [0., 0.25, 0.5, 0.75, 1.]</span>
</pre></div>
</div>
<p>Note that in the last case, the edges of the domain (0,1) are included, and is probably the outcome you want in most cases.</p>
<div class="admonition-do-not-mix-numpy-arrays-and-lists-in-functions admonition">
<p class="admonition-title">Do not mix Numpy arrays and lists in functions</p>
<p>If a function is written to use  Numpy arrays as <em>arguments</em>, make sure that it <em>returns</em> Numpy arrays. If you have to use a list inside the function to e.g. store the results of a calculation, convert the list to a Numpy array before returning it by <code class="docutils literal notranslate"><span class="pre">np.array(my_list)</span></code>.</p>
</div>
<div class="section" id="array-slicing">
<h4>Array slicing<a class="headerlink" href="#array-slicing" title="Permalink to this headline">¶</a></h4>
<p>As with lists you can access elements in Numpy arrays in the same way as lists, the syntax is <code class="docutils literal notranslate"><span class="pre">my_array[start,stop,step]</span></code></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">my_array</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="n">my_array</span><span class="p">[:]</span>      <span class="c1"># [0,1,2,3,4,5]</span>
<span class="n">my_array</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>     <span class="c1"># [1,2,3,4,5]</span>
<span class="n">my_array</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>    <span class="c1"># [0,1,2,3,4]</span>
<span class="n">my_array</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>   <span class="c1"># [1,2,3,4]</span>
<span class="n">my_array</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">]</span> <span class="c1"># [1,3]</span>
<span class="n">my_array</span><span class="p">[::</span><span class="mi">2</span><span class="p">]</span>    <span class="c1"># [0,2,4]</span>
</pre></div>
</div>
<p>However, as opposed to lists all the basic mathematical operations addition, subtraction, multiplication are meaningful (<em>if the arrays have equal length, or shape</em>)</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>my_array  = np.array([0,1,2])
my_array2 = np.array([3,4,5])
my_array+my_array2 # [3,5,7]
my_array*my_array2 # [0,4,10]
my_array/my_array2 # [0,.25,.4]
</pre></div>
</div>
<p>Note that the operations does what you would expect them to do. If we have arrays of arrays, we can easily access elements in the arrays</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>my_array  = np.array([[0,1,2],[3,4,5]])
my_array[0,:] # [0,1,2]
my_array[1,:] # [3,4,5]
my_array[:,0] # [0,3]
my_array[:,1] # [1,4]
</pre></div>
</div>
<p>Not the extra <code class="docutils literal notranslate"><span class="pre">[]</span></code> in the definition of <code class="docutils literal notranslate"><span class="pre">my_array</span></code>.  Numpy arrays have a shape property, which makes it very easy to create different matrices. The array <code class="docutils literal notranslate"><span class="pre">[0,1,2,3,4,5]</span></code> has shape (6,), but we can change the shape to create e.g. a <span class="math notranslate nohighlight">\(2\times3\)</span> matrix</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">my_array</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">])</span>
<span class="n">my_array</span><span class="o">.</span><span class="n">shape</span> <span class="o">=</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span> <span class="c1"># [[0,1,2],[3,4,5]]</span>
<span class="n">my_array</span><span class="o">.</span><span class="n">shape</span> <span class="o">=</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="c1"># [[0,1],[2,3],[4,5]]</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="looping">
<h2>Looping<a class="headerlink" href="#looping" title="Permalink to this headline">¶</a></h2>
<p>There are basically two ways of iterating through lists or to do a series of computations, using a for-loop or a while-loop. During a numerical computation we typically iterate through time, from time zero to the end time to calculate e.g. the position of an object.</p>
<div class="section" id="for-loops">
<h3>For loops<a class="headerlink" href="#for-loops" title="Permalink to this headline">¶</a></h3>
<p>A typical example of a for loop is to loop over a list and do something, and maybe during the execution we would like to store the results in a list</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">numbers</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;one&#39;</span><span class="p">,</span><span class="s1">&#39;two&#39;</span><span class="p">,</span><span class="s1">&#39;three&#39;</span><span class="p">,</span><span class="s1">&#39;one&#39;</span><span class="p">,</span><span class="s1">&#39;two&#39;</span><span class="p">]</span>
<span class="n">result</span><span class="o">=</span><span class="p">[]</span> <span class="c1"># has to be declared as empty</span>
<span class="k">for</span> <span class="n">number</span> <span class="ow">in</span> <span class="n">numbers</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">number</span> <span class="o">==</span> <span class="s1">&#39;one&#39;</span><span class="p">:</span>
       <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<p>After executing this code <code class="docutils literal notranslate"><span class="pre">result=[1,</span> <span class="pre">1]</span></code>. The <code class="docutils literal notranslate"><span class="pre">number</span></code> variable changes during the iteration, and takes the value of each element in the list. Note that I use <code class="docutils literal notranslate"><span class="pre">numbers</span></code> for the list and <code class="docutils literal notranslate"><span class="pre">number</span></code> as the iterator, this makes it quite easy to read and understand the code. In many cases you want to have the index, not only the element in the list</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">numbers</span>  <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;one&#39;</span><span class="p">,</span><span class="s1">&#39;two&#39;</span><span class="p">,</span><span class="s1">&#39;three&#39;</span><span class="p">,</span><span class="s1">&#39;one&#39;</span><span class="p">,</span><span class="s1">&#39;two&#39;</span><span class="p">]</span>
<span class="n">numerics</span> <span class="o">=</span> <span class="p">[</span>  <span class="mi">1</span>  <span class="p">,</span>  <span class="mi">2</span>  <span class="p">,</span>   <span class="mi">3</span>   <span class="p">,</span> <span class="mi">1</span>   <span class="p">,</span> <span class="mi">2</span>   <span class="p">]</span>
<span class="n">result</span><span class="o">=</span><span class="p">[]</span> <span class="c1"># has to be declared as empty</span>
<span class="k">for</span> <span class="n">idx</span><span class="p">,</span><span class="n">number</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">numbers</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">number</span> <span class="o">==</span> <span class="s1">&#39;one&#39;</span><span class="p">:</span>
       <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">numerics</span><span class="p">[</span><span class="n">idx</span><span class="p">])</span>
</pre></div>
</div>
<p>After executing this code <code class="docutils literal notranslate"><span class="pre">result=[1,</span> <span class="pre">1]</span></code>. In this case the function <code class="docutils literal notranslate"><span class="pre">enumerate(numbers)</span></code> returns two values: the index, which is stored in <code class="docutils literal notranslate"><span class="pre">idx</span></code>, and the value of the list element, which is stored in <code class="docutils literal notranslate"><span class="pre">number</span></code>.</p>
<p>In many cases you might be in a situation that you want to plot more than one function in a plot. It is then very tempting to copy and paste the previous code, but it is more elegant to use a for loop and lists</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="n">x_val</span>   <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">100</span><span class="p">)</span> <span class="c1"># 100 equal spaced points from 0 to 1</span>
<span class="n">y_vals</span>  <span class="o">=</span> <span class="p">[</span><span class="n">x_val</span><span class="p">,</span><span class="n">x_val</span><span class="o">*</span><span class="n">x_val</span><span class="p">]</span>
<span class="n">labels</span>  <span class="o">=</span> <span class="p">[</span><span class="sa">r</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;$x^2$&#39;</span><span class="p">]</span>
<span class="n">cols</span>    <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;r&#39;</span><span class="p">,</span><span class="s1">&#39;g&#39;</span><span class="p">]</span>
<span class="n">points</span>  <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;-*&#39;</span><span class="p">,</span><span class="s1">&#39;-^&#39;</span><span class="p">]</span>
<span class="k">for</span> <span class="n">idx</span><span class="p">,</span><span class="n">y_val</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">y_vals</span><span class="p">):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_val</span><span class="p">,</span><span class="n">y_val</span><span class="p">,</span><span class="n">points</span><span class="p">[</span><span class="n">idx</span><span class="p">],</span><span class="n">c</span><span class="o">=</span><span class="n">cols</span><span class="p">[</span><span class="n">idx</span><span class="p">],</span><span class="n">label</span><span class="o">=</span><span class="n">labels</span><span class="p">[</span><span class="n">idx</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="section" id="while-loops">
<h3>While loops<a class="headerlink" href="#while-loops" title="Permalink to this headline">¶</a></h3>
<p>In most cases a for loop can also be written as a while loops and vice versa. In python you would prefer to use a for loop whenever you are iterating over a fixed number of elements. This makes the code easy to read. In cases where we are waiting for input or time is involved it may make more sense to use a while loop. Typically you would use a while loop when you do not know at the start when to stop iterating. The syntax of the while loop is to do something while a condition is true</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="n">finished</span> <span class="o">=</span> <span class="kc">False</span>
<span class="nb">sum</span> <span class="o">=</span><span class="mi">0</span>
<span class="k">while</span> <span class="ow">not</span> <span class="n">finished</span><span class="p">:</span>
      <span class="nb">sum</span> <span class="o">+=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">()</span>
      <span class="k">if</span> <span class="nb">sum</span> <span class="o">&gt;=</span> <span class="mf">10.</span><span class="p">:</span>
             <span class="n">finished</span> <span class="o">=</span> <span class="kc">True</span>
</pre></div>
</div>
<p>In some cases we are iterating from <span class="math notranslate nohighlight">\(t_0\)</span>, <span class="math notranslate nohighlight">\(t_1\)</span>, etc. to a final time <span class="math notranslate nohighlight">\(t_f\)</span>, if we use a fixed time step, <span class="math notranslate nohighlight">\(\Delta t\)</span>, we can calculate the number of steps at the beginning i.e <span class="math notranslate nohighlight">\(N= \text{int} ((t_f-t_0)/\Delta t)\)</span>, and use a for loop. On the other hand, in the more fancy algorithm we change the time step as the simulation proceeds and then we would choose a while loop, e.g. <code class="docutils literal notranslate"><span class="pre">while</span> <span class="pre">t0</span> <span class="pre">&lt;=</span> <span class="pre">tf:</span></code>.
Functions in Python
-------------------
When to use functions? There is no particular rule, <em>but whenever you
start to copy and paste code from one place to another, you should
consider to use a function</em>. Functions makes the code easier to read.
It is not easy to identify which part of a program is a good candidate
for a function, it requires skill and experience. Most likely you will
end up changing the function definitions as your program develops.</p>
<div class="admonition-use-short-functions admonition">
<p class="admonition-title">Use short functions</p>
<p>Short functions makes the code easier to read. Each function has a particular task, and it does only one thing. If functions does too many tasks there is a chance that you will have several functions doing some of the same operations. Whenever you want to extend the program you might have to make changes several places in the code. The chance then is that you will forget to do the change in some of the functions and introduce a bug.</p>
</div>
</div>
<div class="section" id="defining-a-mathematical-function">
<h3>Defining a mathematical function<a class="headerlink" href="#defining-a-mathematical-function" title="Permalink to this headline">¶</a></h3>
<p>Throughout this course you will write many functions that does mathematical operations. In many cases you would also pass a function to another function to make your code more modular. Lets say we want to calculate the derivative of <span class="math notranslate nohighlight">\(\sin x\)</span>, using the most basic definition of a derivative <span class="math notranslate nohighlight">\(f^\prime(x) = f(x+\Delta x)-f(x)/\Delta x\)</span>, we could do it as</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">derivative_of_sine</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">delta_x</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39; returns the derivative of sin x &#39;&#39;&#39;</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="o">+</span><span class="n">delta_x</span><span class="p">)</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">))</span><span class="o">/</span><span class="n">delta_x</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;The derivative of sinx at x=0 is :&#39;</span><span class="p">,</span> <span class="n">derivative_of_sine</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mf">1e-3</span><span class="p">))</span>
</pre></div>
</div>
<p>If we would like to calculate the derivative in multiple points, that is straight forward since we have used the Numpy version of <span class="math notranslate nohighlight">\(\sin x\)</span>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">x</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="o">.</span><span class="mi">5</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;The derivative of sinx at x=0,0.5,1 is :&#39;</span><span class="p">,</span> <span class="n">derivative_of_sine</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="mf">1e-3</span><span class="p">))</span>
</pre></div>
</div>
<p>We will return in a later chapter why <span class="math notranslate nohighlight">\(\Delta x=10^{-3}\)</span> is a reasonable choice.
However, the challenge with our implementation is that if we want to calculate the derivative of another function we have to implement the derivative rule again for that function. It is better to have a separate function that calculates the derivative</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">df</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">f</span><span class="p">,</span><span class="n">delta_x</span><span class="o">=</span><span class="mf">1e-3</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39; returns the derivative of f &#39;&#39;&#39;</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="o">+</span><span class="n">delta_x</span><span class="p">)</span><span class="o">-</span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">))</span><span class="o">/</span><span class="n">delta_x</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;The derivative of sinx at x=0 is :&#39;</span><span class="p">,</span> <span class="n">df</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">f</span><span class="p">))</span>
</pre></div>
</div>
<p>Note also that we have put <code class="docutils literal notranslate"><span class="pre">delta_x=1e-3</span></code> as a <em>default argument</em>. Default arguments have to come at the end of the argument lists, <code class="docutils literal notranslate"><span class="pre">df(x,delta_x=1e-3,f)</span></code> is not allowed. All of this looks well and good, but what you would experience is that your functions would not be as simple as <span class="math notranslate nohighlight">\(\sin x\)</span>. In many cases your functions need additional arguments to be evaluated e.g.:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">s</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">s0</span><span class="p">,</span><span class="n">v0</span><span class="p">,</span><span class="n">a</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    s0 : initial starting point</span>
<span class="sd">    v0 : initial velocity</span>
<span class="sd">    a  : acceleration</span>
<span class="sd">    returns the distance traveled</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="k">return</span> <span class="n">s0</span><span class="o">+</span><span class="n">v0</span><span class="o">*</span><span class="n">t</span><span class="o">+</span><span class="n">a</span><span class="o">*</span><span class="n">t</span><span class="o">*</span><span class="n">t</span><span class="o">/</span><span class="mi">2</span>
</pre></div>
</div>
<p>How can we calculate the derivative of this function? If we try to do <code class="docutils literal notranslate"><span class="pre">df(1,s)</span></code> we will get the following message</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="ne">TypeError</span><span class="p">:</span> <span class="n">s</span><span class="p">()</span> <span class="n">missing</span> <span class="mi">3</span> <span class="n">required</span> <span class="n">positional</span>
       <span class="n">arguments</span><span class="p">:</span> <span class="s1">&#39;s0&#39;</span><span class="p">,</span> <span class="s1">&#39;v0&#39;</span><span class="p">,</span> <span class="ow">and</span> <span class="s1">&#39;a&#39;</span>
</pre></div>
</div>
<p>This happens because the <code class="docutils literal notranslate"><span class="pre">df</span></code> function expect that the function we send into the argument list has a call signature <code class="docutils literal notranslate"><span class="pre">f(x)</span></code>. What many people do is that they use global variable, that is to define <code class="docutils literal notranslate"><span class="pre">s0,</span> <span class="pre">v0,</span> <span class="pre">a</span></code> at the top of the code. This is not a good solution. Python has a special variable <code class="docutils literal notranslate"><span class="pre">*args</span></code> which can be used to pass multiple arguments to your function, thus if we rewrite <code class="docutils literal notranslate"><span class="pre">df</span></code> like this</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="o">*</span><span class="n">args</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">df</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">f</span><span class="p">,</span><span class="o">*</span><span class="n">args</span><span class="p">,</span><span class="n">delta_x</span><span class="o">=</span><span class="mf">1e-3</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39; returns the derivative of f &#39;&#39;&#39;</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="o">+</span><span class="n">delta_x</span><span class="p">,</span><span class="o">*</span><span class="n">args</span><span class="p">)</span><span class="o">-</span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="o">*</span><span class="n">args</span><span class="p">))</span><span class="o">/</span><span class="n">delta_x</span>
</pre></div>
</div>
<p>we can do (assuming <code class="docutils literal notranslate"><span class="pre">s0=0</span></code>, <code class="docutils literal notranslate"><span class="pre">v0=1</span></code>, and <code class="docutils literal notranslate"><span class="pre">a=9.8</span></code>)</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;The derivative of sinx at x=0 is :&#39;</span><span class="p">,</span> <span class="n">df</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">f</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;The derivative of s(t) at t=1 is :&#39;</span><span class="p">,</span> <span class="n">df</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">s</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mf">9.8</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="section" id="scope-of-variables">
<h3>Scope of variables<a class="headerlink" href="#scope-of-variables" title="Permalink to this headline">¶</a></h3>
<p>In small programs you would not care about scope, but once you have several functions, you will easily get into trouble if you do not consider the scope of a variable. By scope of a variable we mean where it is available, first some simple examples</p>
<p><strong>A variable created inside a function is only available within the function:</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="n">a</span><span class="o">=</span><span class="mi">10</span>
    <span class="n">b</span><span class="o">=</span><span class="mi">20</span>
    <span class="k">return</span> <span class="n">a</span><span class="o">*</span><span class="n">x</span><span class="o">+</span><span class="n">b</span>
</pre></div>
</div>
<p>Doing <code class="docutils literal notranslate"><span class="pre">print(a)</span></code> outside the function would create an error: <code class="docutils literal notranslate"><span class="pre">name</span> <span class="pre">'a'</span> <span class="pre">is</span> <span class="pre">not</span> <span class="pre">defined</span></code>. What happens if we defined a variable <code class="docutils literal notranslate"><span class="pre">a</span></code> outside the function</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">a</span><span class="o">=</span><span class="mi">2</span>
<span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="n">a</span><span class="o">=</span><span class="mi">10</span>
    <span class="n">b</span><span class="o">=</span><span class="mi">20</span>
    <span class="k">return</span> <span class="n">a</span><span class="o">*</span><span class="n">x</span><span class="o">+</span><span class="n">b</span>
</pre></div>
</div>
<p>If we first call the function <code class="docutils literal notranslate"><span class="pre">f(0)</span></code>, and then do <code class="docutils literal notranslate"><span class="pre">print(a)</span></code> Python would give the answer <code class="docutils literal notranslate"><span class="pre">2</span></code>, <em>not</em> <code class="docutils literal notranslate"><span class="pre">10</span></code>. A <em>local</em> variable <code class="docutils literal notranslate"><span class="pre">a</span></code> is created inside <code class="docutils literal notranslate"><span class="pre">f(x)</span></code>, that does not interfere with the variable <code class="docutils literal notranslate"><span class="pre">a</span></code> defined outside the function.
<strong>The ``global`` keyword can be used to pass and access variables in functions:</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">global</span> <span class="n">a</span>
<span class="n">a</span><span class="o">=</span><span class="mi">2</span>
<span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">global</span> <span class="n">a</span>
    <span class="n">a</span><span class="o">=</span><span class="mi">10</span>
    <span class="n">b</span><span class="o">=</span><span class="mi">20</span>
    <span class="k">return</span> <span class="n">a</span><span class="o">*</span><span class="n">x</span><span class="o">+</span><span class="n">b</span>
</pre></div>
</div>
<p>In this case <code class="docutils literal notranslate"><span class="pre">print(a)</span></code> <em>before</em> calling <code class="docutils literal notranslate"><span class="pre">f(x)</span></code> would give the answer <code class="docutils literal notranslate"><span class="pre">2</span></code> and <em>after</em> calling <code class="docutils literal notranslate"><span class="pre">f(x)</span></code> would give <code class="docutils literal notranslate"><span class="pre">10</span></code>.</p>
<div class="admonition-use-of-global-variables admonition">
<p class="admonition-title">Use of global variables</p>
<p>Sometimes global variables can be very useful, and help you to make the code simpler. But, make sure to use a <em>naming convention</em>  for them, e.g. end all the global variables with an underscore. In the example above we would write <code class="docutils literal notranslate"><span class="pre">global</span> <span class="pre">a_</span></code>. A person reading the code would then know that all variables ending with an underscore are global, and can be altered by many functions.</p>
</div>
</div>
</div>
</div>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="index.html">_</a></h1>








<h3>Navigation</h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="._book000.html">Modeling and Computational Engineering</a></li>
<li class="toctree-l1"><a class="reference internal" href="._book001.html">Preface</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Writing Python code</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#personal-guidelines">Personal Guidelines</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#code-editor">Code editor</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#types-in-python">Types in Python</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#basic-types">Basic types</a></li>
<li class="toctree-l3"><a class="reference internal" href="#lists">Lists</a></li>
<li class="toctree-l3"><a class="reference internal" href="#numpy-arrays">Numpy arrays</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#looping">Looping</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#for-loops">For loops</a></li>
<li class="toctree-l3"><a class="reference internal" href="#while-loops">While loops</a></li>
<li class="toctree-l3"><a class="reference internal" href="#defining-a-mathematical-function">Defining a mathematical function</a></li>
<li class="toctree-l3"><a class="reference internal" href="#scope-of-variables">Scope of variables</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="._book003.html">Finite differences</a></li>
<li class="toctree-l1"><a class="reference internal" href="._book004.html">Solving linear systems</a></li>
<li class="toctree-l1"><a class="reference internal" href="._book005.html">Solving nonlinear equations</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
      <li>Previous: <a href="._book001.html" title="previous chapter">Preface</a></li>
      <li>Next: <a href="._book003.html" title="next chapter">Finite differences</a></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2022, Modeling and Computational Engineering.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 2.3.1</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="_sources/._book002.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>